<svg xmlns="http://www.w3.org/2000/svg" width="800" height="160" viewBox="0 0 800 160">
  <style>
    /* ── Fonts ── */
    .mono { font-family: 'Fira Code', 'Consolas', 'Liberation Mono', monospace; }

    /* ── Shield movement: travels across 5 stage boxes ──
         Each box is 120px wide, gap 16px, first box at x=28.
         Shield starts at x=28 and ends at x=572.
         Total cycle: 7s traverse + 1s pause = 8s */
    @keyframes shieldMove {
      0%        { transform: translateX(0px);   opacity: 0; }
      2%        { transform: translateX(0px);   opacity: 1; }
      /* Stage 0: x=28,  hold 0-16.6% */
      14%       { transform: translateX(0px);   opacity: 1; }
      /* Stage 1: x=164, hold ~16.6-33.2% */
      16.6%     { transform: translateX(136px); opacity: 1; }
      28%       { transform: translateX(136px); opacity: 1; }
      /* Stage 2: x=300, hold ~33.2-49.8% */
      33.2%     { transform: translateX(272px); opacity: 1; }
      44%       { transform: translateX(272px); opacity: 1; }
      /* Stage 3: x=436, hold ~49.8-66.4% */
      49.8%     { transform: translateX(408px); opacity: 1; }
      60%       { transform: translateX(408px); opacity: 1; }
      /* Stage 4: x=572, hold ~66.4-83% */
      66.4%     { transform: translateX(544px); opacity: 1; }
      78%       { transform: translateX(544px); opacity: 1; }
      /* Exit */
      85%       { transform: translateX(680px); opacity: 0.3; }
      87%       { transform: translateX(700px); opacity: 0; }
      100%      { transform: translateX(700px); opacity: 0; }
    }

    /* ── Stage box glow: each stage lights up when shield is inside ── */
    @keyframes glowStage0 {
      0%, 2%     { filter: brightness(1); }
      3%, 14%    { filter: brightness(1.6) drop-shadow(0 0 6px #1D3557); }
      16%, 100%  { filter: brightness(1); }
    }
    @keyframes glowStage1 {
      0%, 15%    { filter: brightness(1); }
      17%, 28%   { filter: brightness(1.6) drop-shadow(0 0 6px #457B9D); }
      30%, 100%  { filter: brightness(1); }
    }
    @keyframes glowStage2 {
      0%, 31%    { filter: brightness(1); }
      33%, 44%   { filter: brightness(1.6) drop-shadow(0 0 6px #E63946); }
      46%, 100%  { filter: brightness(1); }
    }
    @keyframes glowStage3 {
      0%, 48%    { filter: brightness(1); }
      50%, 60%   { filter: brightness(1.6) drop-shadow(0 0 6px #FF6B35); }
      62%, 100%  { filter: brightness(1); }
    }
    @keyframes glowStage4 {
      0%, 64%    { filter: brightness(1); }
      66%, 78%   { filter: brightness(1.6) drop-shadow(0 0 6px #2A9D8F); }
      80%, 100%  { filter: brightness(1); }
    }

    /* ── Verdict alternation: green/red glow after shield arrives ── */
    @keyframes verdictGlow {
      0%, 63%   { opacity: 0; }
      66%, 78%  { opacity: 1; }
      80%, 100% { opacity: 0; }
    }
    @keyframes verdictSafe {
      0%, 63%       { opacity: 0; }
      66%           { opacity: 1; }
      72%           { opacity: 1; }
      73%, 100%     { opacity: 0; }
    }
    @keyframes verdictMalicious {
      0%, 72%       { opacity: 0; }
      73%           { opacity: 1; }
      78%           { opacity: 1; }
      80%, 100%     { opacity: 0; }
    }

    /* ── Arrow pulse ── */
    @keyframes arrowPulse {
      0%, 100% { opacity: 0.25; }
      50%      { opacity: 0.6; }
    }

    /* ── Apply animations ── */
    .shield    { animation: shieldMove 8s ease-in-out infinite; opacity: 0; }
    .stage0    { animation: glowStage0 8s ease-in-out infinite; }
    .stage1    { animation: glowStage1 8s ease-in-out infinite; }
    .stage2    { animation: glowStage2 8s ease-in-out infinite; }
    .stage3    { animation: glowStage3 8s ease-in-out infinite; }
    .stage4    { animation: glowStage4 8s ease-in-out infinite; }
    .verdict-safe      { animation: verdictSafe 8s ease-in-out infinite; opacity: 0; }
    .verdict-malicious { animation: verdictMalicious 8s ease-in-out infinite; opacity: 0; }
    .arrow     { animation: arrowPulse 2s ease-in-out infinite; }
  </style>

  <defs>
    <!-- Shield icon path (simple badge/shield shape, ~20x24) -->
    <path id="shieldIcon" d="M10 0 C10 0 0 3 0 3 L0 13 C0 19 10 24 10 24 C10 24 20 19 20 13 L20 3 C20 3 10 0 10 0 Z" fill="#F1FAEE"/>
    <!-- Glow filter for verdict -->
    <filter id="glowGreen" x="-30%" y="-30%" width="160%" height="160%">
      <feGaussianBlur stdDeviation="4" result="blur"/>
      <feFlood flood-color="#3fb950" flood-opacity="0.6" result="color"/>
      <feComposite in="color" in2="blur" operator="in" result="glow"/>
      <feMerge><feMergeNode in="glow"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="glowRed" x="-30%" y="-30%" width="160%" height="160%">
      <feGaussianBlur stdDeviation="4" result="blur"/>
      <feFlood flood-color="#E63946" flood-opacity="0.6" result="color"/>
      <feComposite in="color" in2="blur" operator="in" result="glow"/>
      <feMerge><feMergeNode in="glow"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- ── Background ── -->
  <rect width="800" height="160" rx="8" fill="#0d1117"/>
  <!-- Subtle top border -->
  <rect width="800" height="1" y="0" rx="8" fill="#30363d" opacity="0.5"/>

  <!-- ── Title ── -->
  <text x="400" y="20" text-anchor="middle" class="mono" fill="#8b949e" font-size="10" font-weight="600">Defense Pipeline</text>

  <!-- ════════════════════════════════════════════════════════
       STAGE BOXES — 5 boxes, each 120x80, spaced 16px apart
       Starting x=28, y=32
       Box positions: 28, 164, 300, 436, 572
       ════════════════════════════════════════════════════════ -->

  <!-- Stage 0: INPUT (#1D3557) -->
  <g class="stage0">
    <rect x="28" y="32" width="120" height="80" rx="6" fill="#1D3557" stroke="#1D3557" stroke-width="1.5" opacity="0.9"/>
    <text x="88" y="58" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="11" font-weight="bold">L0 Input</text>
    <text x="88" y="73" text-anchor="middle" class="mono" fill="#A8DADC" font-size="7.5">Unicode . OCR</text>
    <text x="88" y="84" text-anchor="middle" class="mono" fill="#A8DADC" font-size="7.5">Docs . Sanitize</text>
  </g>

  <!-- Arrow 0-1 -->
  <g class="arrow" style="animation-delay: 0s;">
    <line x1="150" y1="72" x2="162" y2="72" stroke="#6e7681" stroke-width="1.5"/>
    <polygon points="162,68 162,76 168,72" fill="#6e7681"/>
  </g>

  <!-- Stage 1: PATTERN (#457B9D) -->
  <g class="stage1">
    <rect x="164" y="32" width="120" height="80" rx="6" fill="#457B9D" stroke="#457B9D" stroke-width="1.5" opacity="0.9"/>
    <text x="224" y="58" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="10" font-weight="bold">L1-L3 Pattern</text>
    <text x="224" y="73" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Regex . Rules</text>
    <text x="224" y="84" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Obfuscation</text>
  </g>

  <!-- Arrow 1-2 -->
  <g class="arrow" style="animation-delay: 0.4s;">
    <line x1="286" y1="72" x2="298" y2="72" stroke="#6e7681" stroke-width="1.5"/>
    <polygon points="298,68 298,76 304,72" fill="#6e7681"/>
  </g>

  <!-- Stage 2: ML (#E63946) -->
  <g class="stage2">
    <rect x="300" y="32" width="120" height="80" rx="6" fill="#E63946" stroke="#E63946" stroke-width="1.5" opacity="0.9"/>
    <text x="360" y="58" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="10.5" font-weight="bold">L4-L5 ML</text>
    <text x="360" y="73" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">TF-IDF . Embed</text>
    <text x="360" y="84" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Neural Scoring</text>
  </g>

  <!-- Arrow 2-3 -->
  <g class="arrow" style="animation-delay: 0.8s;">
    <line x1="422" y1="72" x2="434" y2="72" stroke="#6e7681" stroke-width="1.5"/>
    <polygon points="434,68 434,76 440,72" fill="#6e7681"/>
  </g>

  <!-- Stage 3: DECISION (#FF6B35) -->
  <g class="stage3">
    <rect x="436" y="32" width="120" height="80" rx="6" fill="#FF6B35" stroke="#FF6B35" stroke-width="1.5" opacity="0.9"/>
    <text x="496" y="55" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="9.5" font-weight="bold">L6-L8</text>
    <text x="496" y="67" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="9.5" font-weight="bold">Decision</text>
    <text x="496" y="82" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Cascade . LLM</text>
    <text x="496" y="93" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Ensemble</text>
  </g>

  <!-- Arrow 3-4 -->
  <g class="arrow" style="animation-delay: 1.2s;">
    <line x1="558" y1="72" x2="570" y2="72" stroke="#6e7681" stroke-width="1.5"/>
    <polygon points="570,68 570,76 576,72" fill="#6e7681"/>
  </g>

  <!-- Stage 4: OUTPUT (#2A9D8F) — base state -->
  <g class="stage4">
    <rect x="572" y="32" width="120" height="80" rx="6" fill="#2A9D8F" stroke="#2A9D8F" stroke-width="1.5" opacity="0.9"/>
    <text x="632" y="55" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="9.5" font-weight="bold">L9-L10</text>
    <text x="632" y="67" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="9.5" font-weight="bold">Output</text>
    <text x="632" y="82" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Format . Log</text>
    <text x="632" y="93" text-anchor="middle" class="mono" fill="#F1FAEE" font-size="7.5" opacity="0.8">Verdict</text>
  </g>

  <!-- ══ Verdict overlays: green SAFE and red MALICIOUS ══ -->
  <!-- Green SAFE overlay -->
  <g class="verdict-safe">
    <rect x="572" y="32" width="120" height="80" rx="6" fill="#3fb950" opacity="0.2" filter="url(#glowGreen)"/>
    <rect x="572" y="32" width="120" height="80" rx="6" fill="none" stroke="#3fb950" stroke-width="2.5"/>
    <text x="632" y="126" text-anchor="middle" class="mono" fill="#3fb950" font-size="10" font-weight="bold">SAFE</text>
  </g>

  <!-- Red MALICIOUS overlay -->
  <g class="verdict-malicious">
    <rect x="572" y="32" width="120" height="80" rx="6" fill="#E63946" opacity="0.2" filter="url(#glowRed)"/>
    <rect x="572" y="32" width="120" height="80" rx="6" fill="none" stroke="#E63946" stroke-width="2.5"/>
    <text x="632" y="126" text-anchor="middle" class="mono" fill="#E63946" font-size="10" font-weight="bold">MALICIOUS</text>
  </g>

  <!-- ══ SHIELD CHARACTER ══
       Positioned at the first box, animated with translateX.
       The shield is centered inside each 120px box.
       Box center x = box_left + 50 (so icon left = box_left + 50 - 10 = box_left + 40).
       First box starts at x=28 so shield x = 68. Vertical: below sublabels, y=92. -->
  <g class="shield">
    <use href="#shieldIcon" x="68" y="92"/>
  </g>

  <!-- ── Bottom status bar ── -->
  <line x1="12" y1="138" x2="788" y2="138" stroke="#30363d" stroke-width="0.5" opacity="0.4"/>
  <text x="28" y="152" class="mono" fill="#6e7681" font-size="8.5">11 Layers | 103 techniques | avg 5ms</text>
  <text x="700" y="152" class="mono" fill="#3fb950" font-size="8.5">ARMED</text>
</svg>